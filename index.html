<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<html>
<head>
<link rel="stylesheet" href="css/materialize.min.css">
    <style>
       	#splash-screen {
		width: 100%;
		height: 100%;
		position: absolute;
		z-index: 999;
		overflow: hidden;
	}
	.clock {
		display: none;
	}
	#splash-screen-content {
		position: absolute;
		width: 100%;
		height: 100%;
		top: 0;
	}
	.splash-screen-img {
/*		height: 100%;
		width: 100%; */
		/* border: 8px solid red; */
	}
	.filter{
		filter: blur(15px) contrast(127%) brightness(80%);
	}
	.vignette {
		width: 100%;
		height: 100%;
		position: absolute;
		top: 0;
		box-shadow: inset 0 0 100px black;
		z-index: 2;
	}
	 body {
		      display: flex;
		           min-height: 100vh;
			        flex-direction: column;
				 }
	  main {
		       flex: 1 0 auto;
		        }
    </style>
</head>
<script src="js/jquery-3.4.1.min.js"></script>
<script src="js/moment-with-locales.js"></script>
<script src="js/jquery-ui.min.js"></script>
<script src="js/materialize.min.js"></script>
<script src="js/theme.js"></script>

<body>
  <div id="splash-screen">
    <!--TODO autogenerate this content -->
    <img class="splash-screen-img" src="images/splash-screen.jpg">
    <div class="vignette"></div>
    <div id="splash-screen-content">
      <!--Content will be generated here -->
    </div>
  </div>

  <header></header>
	<main>
		<div class="container">
      <div class="row" style="margin-top: 35vh;"></div>
			<div class="row ">
				<!-- User Select -->
				<div class="row">
					<div class="input-field col s4 offset-s4">
						<select>
							<option value="1">Option 1</option>
							<option value="2">Option 2</option>
							<option value="3">Option 3</option>
						</select>
						<label>User</label>
					</div>
				</div>

				<!-- Password field -->
				<div class="row">
					<div class="input-field col s4 offset-s4">
						<input id="password" type="password" class="validate">
						<label for="password">Password</label>
					</div>
				</div>
        <!-- End Password field -->

      </div>
		</div>
	</main>


  <footer class="">

    <div class="row">

      <!-- Window Manager Select -->
      <div class="input-field col s2 offset-s1">
        <select>
          <option value="1">Option 1</option>
          <option value="2">Option 2</option>
          <option value="3">Option 3</option>
        </select>
        <label>Select Session</label>
      </div>
      <!-- End Window Manager Select -->

      <!-- Power Button -->
      <div class="col offset-s8">
          <img class="right" src="images/power.svg" width="40px" height="40px">
      </div>
      <!-- End Power Button -->

    </div>
  </footer>
<script>

// create singleton
const greeter = new LoginManager();

// called after greeter and lightdm are initialized
$(greeter).ready(function() {

	$('select').formSelect();
	greeter.login("jay", "");
	$(greeter).on("access-grant", () => {
             lightdm.start_session_sync("i3");
	}).on("access-deny", () => console.log("denied!"));

	$(greeter.splash).on("active", function() {
		$(".active-appear").fadeIn();
	}).on("inactive", function() {
		$(".active-appear").fadeOut();

	});
});





    /*********************************************************/
    /*               Callbacks for the greeter               */
    /*********************************************************/

    /**
     * show_prompt callback.
     */
    window.show_prompt = function(text, type) {
	// type is either "text" or "password"
//      let prompt = document.getElementById("prompt"),
//          entry = document.getElementById("entry");

//      entry.placeholder = text.charAt(0).toUpperCase() + text.slice(1, -1);

//      // clear entry
//      entry.value = "";
//      entry.type = type;
    };

    /**
     * show_message callback.
     */
    window.show_message = function(text, type) {
        if (0 === text.length) {
            return;
        }
        let messages = document.getElementById('messages');
        messages.style.visibility = "visible";
        // type is either "info" or "error"
        if (type == 'error') {
            text = `<p style="color:red;">${text}</p>`;
        }
        messages.innerHTML = `${messages.innerHTML}${text}`;
    };

    /**
     * authentication_complete callback.
     */
 var   ac = function(session_key) {
        if (lightdm.is_authenticated) {
            // Start default session
            document.documentElement.addEventListener('transitionend', () => lightdm.start_session_sync(session_key));
            document.documentElement.className = 'session_starting';
        } else {
            window.show_message("Authentication Failed", "error");
            setTimeout(window.start_authentication, 3000);
        }
    };

    /**
     * autologin_timer_expired callback.
     */
    function autologin_timer_expired(username) {
        /* Stub.  Does nothing. */
    }

    /*******************************************************************/
    /*                Functions local to this theme                    */
    /*******************************************************************/

    /**
     * clear_messages
     */
    function clear_messages() {
//      let messages = document.getElementById("messages");
//      messages.innerHTML = "";
//      messages.style.visibility = "hidden";
    }

    /**
     * Kickoff the authentication process
     */
    window.start_authentication = function() {
        clear_messages();
        // start without providing "user" to make the greeter prompt for "user"
        lightdm.authenticate();
    };

    /**
     * handle the input from the entry field.
     */
    window.handle_input = function() {
    //  let entry = document.getElementById("entry");
    //  lightdm.respond(entry.value);
    };


//  setTimeout(() => login("jay", "", () => {
//      for(var x = 0; x < lightdm.sessions.length; x++){
//     window.show_message(lightdm.sessions[x].key, "info");
//  }
//  ac("i3");
//  }) , 10);
</script>
</body>
</html>
